<h1>Homepage</h1>
<div class="article-list">
   {{#articles}} 
   <article>
    <a href="/article/{{slug}}">
    <img src="/images/{{image}}">
     </a>
     <h2>
        <a href="/article/{{slug}}">
       {{name}} 
        </a>
        </h2>
   </article>
  {{/articles}} 
</div>

<!-- Kustutamise kinnituse popup -->
<div id="deleteModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1000;">
    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: white; padding: 30px; border-radius: 5px; max-width: 500px; width: 90%; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
        <h2 style="margin-top: 0;">Kustuta artikkel</h2>
        <p id="deleteMessage">Kas oled kindel, et soovid selle artikli kustutada?</p>
        <div style="display: flex; gap: 12px; margin-top: 24px;">
            <button class="danger" onclick="deleteArticle()">Jah, kustuta</button>
            <button onclick="closeModal()">Tühista</button>
        </div>
    </div>
</div>

<script>
let articleToDelete = null;

function confirmDelete(articleId, articleName) {
    articleToDelete = articleId;
    document.getElementById('deleteMessage').textContent = 
        `Kas oled kindel, et soovid artikli "${articleName}" kustutada?`;
    document.getElementById('deleteModal').style.display = 'block';
}

function closeModal() {
    document.getElementById('deleteModal').style.display = 'none';
    articleToDelete = null;
}

async function deleteArticle() {
    if (!articleToDelete) return;
    
    try {
        const response = await fetch(`/article/delete/${articleToDelete}`, {
            method: 'DELETE'
        });
        
        const data = await response.json();
        
        if (response.ok) {
            alert(data.message);
            location.reload();
        } else {
            alert('Viga: ' + data.error);
        }
    } catch (error) {
        alert('Midagi läks valesti: ' + error.message);
    }
    
    closeModal();
}

// Sulge modaal kui klikitakse väljaspool
document.getElementById('deleteModal').addEventListener('click', function(e) {
    if (e.target === this) {
        closeModal();
    }
});
</script>